@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix ff: <https://foerderfunke.org/default#> .
@prefix fim: <https://schema.fim.fitko.net/fields/baukasten/> .

ff:metadata ff:author ff:benjaminaaron ;
             ff:created "2024-01-04"^^xsd:date ;
             ff:modified "2024-01-07"^^xsd:date ;
             ff:title "Housing Benefit" .

ff:WohnflaecheAndMieteExistConstraint
    a sh:NodeShape ;
    sh:targetClass ff:Citizen ;
    sh:property [
          sh:path ff:hasF00003175Value ;
          sh:minCount 1 ;
          sh:message "Wohnflaeche must be set" ;
      ] ;
    sh:property [
          sh:path ff:hasF00000240Value ;
          sh:minCount 1 ;
          sh:message "Miete must be set" ;
      ] .

ff:PricePerSquareMeterConstraint
    a sh:NodeShape ;
    sh:targetClass ff:Citizen ;
    sh:sparql [
          a sh:SPARQLConstraint ;
          sh:message "Price per square meter exceeds 16" ;
          sh:select """
            PREFIX ff: <https://foerderfunke.org/default#>
            SELECT $this WHERE {
                $this ff:hasF00003175Value ?area .
                $this ff:hasF00000240Value ?rent .
                FILTER(?rent / ?area > 16) .
            }
        """ ;
      ] .
